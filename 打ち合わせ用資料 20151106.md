打ち合わせ用資料 2015/11/06
===

## 実験プラン

以下の コスト式 がうまく使えるか試す． 

$$ ETE = l_a + (d_a) / (s_a) $$

ただし$l_a$をビュークエリaの実行時間，$d_a$をビュークエリaの結果のデータサイズ，$s_a$をデータの転送時間とする．

## 実験環境

* Master マシン
	* Macbook Pro (Core i5 2.7GHz)

* Slave マシン 
	* Ubuntu 14.04 3台(on VMWare Fusion)
		* 台数が増えた時柔軟に対応できるため
		* ネットワークの帯域を絞るのにマシンごと絞るのが一番簡単な(他のやり方がわからない)ため (今まで使っていた共用LODマシン 130.158.76.22 で絞ると他が使えなくなる)

## 使用クエリ

Product ビュー

```
DEFINE get:refresh "0"
DEFINE get:soft "replace"
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX bsbm: <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
SELECT * WHERE { ?prdct rdf:type bsbm:Product .
?prdct rdfs:label ?prdctlbl .
?prdct bsbm:productFeature ?prdctft .
?prdct bsbm:productPropertyNumeric1 ?value1 .
?prdct bsbm:productPropertyNumeric2 ?value2 .
?prdct bsbm:productPropertyTextual1 ?text1 .
?prdct bsbm:productPropertyTextual2 ?text2 .
?prdct bsbm:productPropertyTextual3 ?text3 .
?prdct dc:date ?pdate .
?prdct bsbm:productType ?pt .
} ",
```

ProductFeature ビュー

```
DEFINE get:refresh "0"
DEFINE get:soft "replace"
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX bsbm: <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/>
PREFIX dc: <http://purl.org/dc/elements/1.1/>  
SELECT * WHERE { ?ft rdf:type bsbm:ProductFeature . 
?ft rdfs:label ?ftlbl . 
?ft rdfs:comment ?ftct .
?ft dc:date ?fdate . }
```

ProductType ビュー (New!)

```sparql
DEFINE get:refresh "0"
DEFINE get:soft "replace"
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX bsbm: <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX bsbm-inst: <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/>
SELECT * WHERE { ?pt rdf:type bsbm:ProductType . 
?pt rdfs:label ?ptlbl . 
?pt rdfs:comment ?ptct . 
?pt dc:date ?ptdate . }
```

## ネットワーク速度の調整

遅延時間に関しては tc で可能：

```
$ sudo tc qdisc add dev eth0 root netem delay 100ms
```

戻すとき：

```
$ sudo tc qdisc del dev eth0 root
```

TODO: rate で帯域幅も絞れる

## コストエスティメータについて

* isql からだとデータの行数は行数を取ることはできる
	* クエリだとどう取る？(とれない？)
		* 案1 コストエスティメータがある　ということにする　→　とりあえず事前に同じビュークエリを投げて時間を測定する

----


* エスティメータ で取れるものは本当に行数だけ？
	* コスト量

* memo
	* PRoduct の select の列数で大きさを調整できる

* 簡単な結果をまず出す

